<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bag of Hope - Pick List Form</title>

    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to bottom right, rgba(134, 178, 211, 0.2), white);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-bottom: 3px solid #c22035;
            padding: 40px 32px;
            margin-bottom: 32px;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 12px rgba(194, 32, 53, 0.08);
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            width: 80px;
            height: 80px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(194, 32, 53, 0.15);
            padding: 8px;
        }

        .logo svg {
            width: 72px;
            height: 72px;
            object-fit: contain;
        }

        .header-text h1 {
            font-size: 36px;
            font-weight: bold;
            color: #c22035;
            /* TODO: Replace with Oakside font when available - current fallback maintains serif look */
            font-family: Georgia, serif;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
            line-height: 1.2;
        }

        .header-text p {
            color: #6c757d;
            font-size: 16px;
            font-weight: 500;
            letter-spacing: 0.3px;
        }

        .form-card {
            background: white;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 32px;
        }

        .section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #c22035;
            /* TODO: Replace with Oakside font when available - current fallback maintains serif look */
            font-family: Georgia, serif;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #c22035;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            color: #060511;
            letter-spacing: 0.5px;
            font-family: 'Poppins', sans-serif;
        }

        label .required {
            color: #c22035;
        }

        input, select, textarea {
            padding: 10px 12px;
            border: 2px solid #86b2d3;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.2s;
            color: #060511;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #c22035;
            box-shadow: 0 0 0 3px rgba(194, 32, 53, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .checkbox-group {
            background: rgba(134, 178, 211, 0.1);
            padding: 16px;
            border-radius: 6px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            font-weight: normal;
            text-transform: none;
            cursor: pointer;
            margin: 0;
        }

        .checkbox-detail {
            display: none;
            margin-left: 26px;
            margin-top: 8px;
            margin-bottom: 8px;
            width: calc(100% - 26px);
        }

        .checkbox-detail.show {
            display: block;
        }

        .checkbox-detail input,
        .checkbox-detail textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #86b2d3;
            border-radius: 4px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: #060511;
        }

        .checkbox-detail textarea {
            min-height: 60px;
            resize: vertical;
        }

        .checkbox-detail label {
            display: block;
            font-size: 12px;
            color: #a7a8a3;
            margin-bottom: 4px;
            font-weight: 400;
        }

        .button-group {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 2px solid #e5e7eb;
        }

        button {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 700;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-family: 'Poppins', sans-serif;
            text-transform: none;
        }

        .btn-primary {
            background: #c22035;
            color: white;
        }

        .btn-primary:hover {
            background: rgba(194, 32, 53, 0.9);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: white;
            color: #c22035;
            border: 2px solid #c22035;
        }

        .btn-secondary:hover {
            background: #c22035;
            color: white;
        }

        .info-box {
            background: rgba(134, 178, 211, 0.2);
            border-left: 4px solid #c22035;
            padding: 16px;
            border-radius: 4px;
            margin-top: 16px;
        }

        .info-box p {
            font-size: 14px;
            color: #060511;
            line-height: 1.6;
        }

        .success-message {
            display: none;
            background: #10b981;
            color: white;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .success-message.show {
            display: block;
        }

        .auto-filled {
            background-color: rgba(134, 178, 211, 0.1);
            position: relative;
        }

        .auto-badge {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: #86b2d3;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
            text-transform: uppercase;
            pointer-events: none;
        }

        .form-group {
            position: relative;
        }

        .helper-text {
            font-size: 11px;
            color: #a7a8a3;
            margin-top: 4px;
            font-style: italic;
            font-family: 'Poppins', sans-serif;
        }

        .helper-text.auto-info {
            color: #86b2d3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <svg viewBox="0 0 226 226" xmlns="http://www.w3.org/2000/svg" width="64" height="64">   <!-- Outer circle with blue border -->   <circle cx="113" cy="113" r="110" fill="white" stroke="#86b2d3" stroke-width="6"/>      <!-- Inner red circle -->   <circle cx="113" cy="113" r="85" fill="#c22035"/>      <!-- "LEAST OF THESE" text on top arc -->   <defs>     <path id="topArc" d="M 38,113 A 75,75 0 0,1 188,113" fill="none"/>   </defs>   <text fill="#86b2d3" font-family="Arial, sans-serif" font-size="16" font-weight="bold" letter-spacing="2">     <textPath href="#topArc" startOffset="50%" text-anchor="middle">       LEAST OF THESE     </textPath>   </text>      <!-- "CAROLINAS" text on bottom arc -->   <defs>     <path id="bottomArc" d="M 38,113 A 75,75 0 0,0 188,113" fill="none"/>   </defs>   <text fill="#86b2d3" font-family="Arial, sans-serif" font-size="20" font-weight="bold" letter-spacing="3">     <textPath href="#bottomArc" startOffset="50%" text-anchor="middle">       CAROLINAS     </textPath>   </text>      <!-- Three children silhouettes in white -->   <g fill="white">     <!-- Left child - running/jumping -->     <circle cx="75" cy="100" r="8"/>     <ellipse cx="75" cy="118" rx="6" ry="12"/>     <line x1="69" y1="112" x2="62" y2="118" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="81" y1="112" x2="88" y2="108" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="71" y1="128" x2="67" y2="140" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="79" y1="128" x2="81" y2="138" stroke="white" stroke-width="3" stroke-linecap="round"/>          <!-- Center child - taller, standing -->     <circle cx="113" cy="92" r="9"/>     <ellipse cx="113" cy="113" rx="7" ry="14"/>     <line x1="106" y1="105" x2="98" y2="110" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="120" y1="105" x2="128" y2="110" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="108" y1="125" x2="106" y2="142" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="118" y1="125" x2="120" y2="142" stroke="white" stroke-width="3" stroke-linecap="round"/>          <!-- Right child - running/jumping -->     <circle cx="151" cy="102" r="7.5"/>     <ellipse cx="151" cy="119" rx="6" ry="11"/>     <line x1="145" y1="113" x2="138" y2="109" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="157" y1="113" x2="164" y2="117" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="147" y1="128" x2="144" y2="136" stroke="white" stroke-width="3" stroke-linecap="round"/>     <line x1="155" y1="128" x2="158" y2="139" stroke="white" stroke-width="3" stroke-linecap="round"/>   </g>      <!-- Red dots on left and right -->   <circle cx="25" cy="113" r="5" fill="#c22035"/>   <circle cx="201" cy="113" r="5" fill="#c22035"/> </svg> 
                </div>
                <div class="header-text">
                    <h1>Least of These Carolinas</h1>
                    <p>Bag of Hope - Pick List Form</p>
                </div>
            </div>
        </div>

        <div class="form-card">
            <div id="successMessage" class="success-message">
                ✓ Pick list submitted successfully!
            </div>

            <form id="bagOfHopeForm">
                <!-- Quick View Information -->
                <div class="section">
                    <h2 class="section-title">Quick View Information</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Child's First Name <span class="required">*</span></label>
                            <input type="text" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label>Child's Last Name <span class="required">*</span></label>
                            <input type="text" name="lastName" required>
                        </div>
                        <div class="form-group">
                            <label>Birthday</label>
                            <input type="date" name="birthday" id="birthday">
                            <div class="helper-text">Enter birthday first - age will auto-calculate</div>
                        </div>
                        <div class="form-group">
                            <label>Child's Age <span class="required">*</span></label>
                            <input type="number" name="age" id="age" min="0" max="18" required readonly>
                            <div class="helper-text">Automatically calculated from birthday above</div>
                        </div>
                        <div class="form-group">
                            <label>Gender <span class="required">*</span></label>
                            <select name="gender" required>
                                <option value="">Select gender</option>
                                <option value="female">Female</option>
                                <option value="male">Male</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ethnicity</label>
                            <select name="ethnicity">
                                <option value="">Select ethnicity</option>
                                <option value="african-american">African American</option>
                                <option value="caucasian">Caucasian</option>
                                <option value="hispanic">Hispanic</option>
                                <option value="asian">Asian</option>
                                <option value="multi-racial">Multi-racial</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Pickup Location <span class="required">*</span></label>
                            <select name="pickupLocation" required>
                                <option value="">Select location</option>
                                <option value="buncombe">Buncombe County/Asheville</option>
                                <option value="charlotte">Charlotte Office</option>
                                <option value="gastonia">Gastonia Center</option>
                                <option value="concord">Concord Location</option>
                                <option value="rock-hill">Rock Hill Center</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Bag Details -->
                <div class="section">
                    <h2 class="section-title">Bag Details</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Bag Embroidery Company</label>
                            <input type="text" name="embroideryCompany">
                        </div>
                        <div class="form-group">
                            <label>Bag Order Number</label>
                            <input type="text" name="orderNumber">
                        </div>
                        <div class="form-group">
                            <label>Bag Embroidery Color (Child's Favorite Color)</label>
                            <select name="embroideryColor" id="embroideryColor">
                                <option value="">Select color</option>
                                <option value="red">Red</option>
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                                <option value="yellow">Yellow</option>
                                <option value="purple">Purple</option>
                                <option value="pink">Pink</option>
                                <option value="orange">Orange</option>
                                <option value="black">Black</option>
                                <option value="white">White</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Toiletry Bag Color</label>
                            <select name="toiletryBagColor" id="toiletryBagColor">
                                <option value="">Select color</option>
                                <option value="red">Red</option>
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                                <option value="pink">Pink</option>
                                <option value="black">Black</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label>Toiletry Bag Labeled</label>
                            <input type="text" name="toiletryBagLabeled" placeholder="Label information">
                        </div>
                    </div>
                </div>

                <!-- Non-Clothing Items -->
                <div class="section">
                    <h2 class="section-title">Non-Clothing Items</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="toy" name="toy" value="toy" data-detail="toy-detail">
                            <label for="toy">Toy/Activity</label>
                        </div>
                        <div id="toy-detail" class="checkbox-detail">
                            <label>Details (size, color, preferences, etc.)</label>
                            <textarea name="toy_details" placeholder="E.g., Size 10 soccer ball, blue stuffed animal, etc."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Clothing Items -->
                <div class="section">
                    <h2 class="section-title">Clothing</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="tops" name="tops" value="tops" data-detail="tops-detail">
                            <label for="tops">Tops</label>
                        </div>
                        <div id="tops-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="tops_details" placeholder="E.g., Size 8, short sleeve">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="bottoms" name="bottoms" value="bottoms" data-detail="bottoms-detail">
                            <label for="bottoms">Bottoms</label>
                        </div>
                        <div id="bottoms-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="bottoms_details" placeholder="E.g., Size 10, jeans">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="pajamas" name="pajamas" value="pajamas" data-detail="pajamas-detail">
                            <label for="pajamas">Pajamas/Sleepwear</label>
                        </div>
                        <div id="pajamas-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="pajamas_details" placeholder="E.g., Size 12">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="underwear" name="underwear" value="underwear" data-detail="underwear-detail">
                            <label for="underwear">Underwear</label>
                        </div>
                        <div id="underwear-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="underwear_details" placeholder="E.g., Size 8">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="diaper" name="diaper" value="diaper" data-detail="diaper-detail">
                            <label for="diaper">Diaper/Pullup/Overnight</label>
                        </div>
                        <div id="diaper-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="diaper_details" placeholder="E.g., Size 4, overnight pullups">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="shoes" name="shoes" value="shoes" data-detail="shoes-detail">
                            <label for="shoes">Shoes (use only if needed)</label>
                        </div>
                        <div id="shoes-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="shoes_details" placeholder="E.g., Size 5, sneakers">
                        </div>

                        <div class="checkbox-item">
                            <input type="checkbox" id="coat" name="coat" value="coat" data-detail="coat-detail">
                            <label for="coat">Coat (use only if needed)</label>
                        </div>
                        <div id="coat-detail" class="checkbox-detail">
                            <label>Size and details</label>
                            <input type="text" name="coat_details" placeholder="E.g., Size 10, winter coat">
                        </div>
                    </div>
                </div>

                <!-- Notes -->
                <div class="section">
                    <h2 class="section-title">Notes</h2>
                    <div class="form-group">
                        <label>Other BOH / Birthday Notes</label>
                        <textarea name="notes" placeholder="Enter any additional notes or special requirements..."></textarea>
                    </div>
                </div>

                <div class="info-box">
                    <p><strong>AFTER the bag has been fully packed:</strong> Update the Request Status to "Packed" in your system.</p>
                </div>

                <!-- Buttons -->
                <div class="button-group">
                    <button type="reset" class="btn-secondary">Clear Form</button>
                    <button type="submit" class="btn-primary">Submit Pick List</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ============================================
        // AUTO-POPULATION LOGIC
        // ============================================

        // Calculate age from birthday
        function calculateAgeFromBirthday(birthday) {
            if (!birthday) return null;

            const today = new Date();
            const birthDate = new Date(birthday);
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();

            // Adjust if birthday hasn't occurred this year
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            return age >= 0 ? age : null;
        }

        // Determine age group from age
        function getAgeGroupFromAge(age) {
            if (age === null || age === undefined || age === '') return '';

            const ageNum = parseInt(age);
            if (isNaN(ageNum)) return '';

            if (ageNum >= 0 && ageNum <= 2) return '0-2';
            if (ageNum >= 3 && ageNum <= 5) return '3-5';
            if (ageNum >= 6 && ageNum <= 11) return '6-11';
            if (ageNum >= 12) return '12+';

            return '';
        }

        // Add visual indicator for auto-filled field
        function markAsAutoFilled(element, sourceField) {
            element.classList.add('auto-filled');

            // Remove existing badge if present
            const existingBadge = element.parentElement.querySelector('.auto-badge');
            if (existingBadge) {
                existingBadge.remove();
            }

            // Add badge
            const badge = document.createElement('span');
            badge.className = 'auto-badge';
            badge.textContent = 'auto';
            badge.title = `Auto-filled from ${sourceField}`;
            element.parentElement.appendChild(badge);
        }

        // Remove auto-fill indicator
        function removeAutoFillIndicator(element) {
            element.classList.remove('auto-filled');
            const badge = element.parentElement.querySelector('.auto-badge');
            if (badge) {
                badge.remove();
            }
        }

        // Get elements
        const birthdayInput = document.getElementById('birthday');
        const ageInput = document.getElementById('age');
        const embroideryColorSelect = document.getElementById('embroideryColor');
        const toiletryBagColorSelect = document.getElementById('toiletryBagColor');

        // Birthday → Age
        birthdayInput.addEventListener('change', function() {
            const calculatedAge = calculateAgeFromBirthday(this.value);

            if (calculatedAge !== null) {
                ageInput.value = calculatedAge;
                markAsAutoFilled(ageInput, 'birthday');
            }
        });


        // Embroidery Color → Toiletry Bag Color
        embroideryColorSelect.addEventListener('change', function() {
            const selectedColor = this.value;

            // Only auto-fill if toiletry bag color is empty
            if (selectedColor && !toiletryBagColorSelect.value) {
                // Check if the selected color exists in toiletry bag options
                const toiletryOptions = Array.from(toiletryBagColorSelect.options).map(opt => opt.value);

                if (toiletryOptions.includes(selectedColor)) {
                    toiletryBagColorSelect.value = selectedColor;
                    markAsAutoFilled(toiletryBagColorSelect, 'embroidery color');
                }
            }
        });

        // Allow manual override of toiletry bag color
        toiletryBagColorSelect.addEventListener('change', function() {
            if (this.value) {
                removeAutoFillIndicator(this);
            }
        });

        // ============================================
        // CHECKBOX DETAIL FIELDS TOGGLE
        // ============================================

        // Add event listeners to all checkboxes with detail fields
        document.querySelectorAll('input[type="checkbox"][data-detail]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const detailId = this.getAttribute('data-detail');
                const detailField = document.getElementById(detailId);

                if (detailField) {
                    if (this.checked) {
                        detailField.classList.add('show');
                        // Focus on the input/textarea when shown
                        const input = detailField.querySelector('input, textarea');
                        if (input) {
                            setTimeout(() => input.focus(), 100);
                        }
                    } else {
                        detailField.classList.remove('show');
                        // Clear the detail field when unchecked
                        const input = detailField.querySelector('input, textarea');
                        if (input) {
                            input.value = '';
                        }
                    }
                }
            });
        });

        // ============================================
        // FORM SUBMISSION
        // ============================================

        document.getElementById('bagOfHopeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            // Get all checked checkboxes
            const checkboxes = this.querySelectorAll('input[type="checkbox"]:checked');
            const checkedItems = Array.from(checkboxes).map(cb => cb.value);
            data.selectedItems = checkedItems;

            // Calculate age group automatically from age (backend logic)
            const age = parseInt(data.age);
            if (!isNaN(age)) {
                data.ageGroup = getAgeGroupFromAge(age);
            }

            // Track which fields were auto-populated
            const autoPopulatedFields = [];
            if (ageInput.classList.contains('auto-filled')) {
                autoPopulatedFields.push('age');
            }
            if (toiletryBagColorSelect.classList.contains('auto-filled')) {
                autoPopulatedFields.push('toiletryBagColor');
            }
            data.autoPopulatedFields = autoPopulatedFields;

            console.log('Form submitted:', data);

            // Show success message
            const successMessage = document.getElementById('successMessage');
            successMessage.classList.add('show');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Hide success message after 3 seconds
            setTimeout(() => {
                successMessage.classList.remove('show');
            }, 3000);

            // Optional: Reset form after submission
            // this.reset();
        });

        // ============================================
        // FORM RESET - Clean up auto-fill indicators
        // ============================================

        document.querySelector('.btn-secondary').addEventListener('click', function() {
            // Remove all auto-fill indicators when form is reset
            document.querySelectorAll('.auto-filled').forEach(el => {
                removeAutoFillIndicator(el);
            });
        });
    </script>
</body>
</html>
