<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bag of Hope - Pick List Form</title>

    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to bottom right, rgba(134, 178, 211, 0.2), white);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-bottom: 2px solid #e5e7eb;
            padding: 24px;
            margin-bottom: 32px;
            border-radius: 8px 8px 0 0;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            width: 64px;
            height: 64px;
            background: #c22035;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo svg {
            width: 40px;
            height: 40px;
            fill: white;
        }

        .header-text h1 {
            font-size: 28px;
            font-weight: bold;
            color: #c22035;
            /* TODO: Replace with Oakside font when available - current fallback maintains serif look */
            font-family: Georgia, serif;
            margin-bottom: 4px;
        }

        .header-text p {
            color: #a7a8a3;
            font-size: 14px;
        }

        .form-card {
            background: white;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 32px;
        }

        .section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #c22035;
            /* TODO: Replace with Oakside font when available - current fallback maintains serif look */
            font-family: Georgia, serif;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #c22035;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            color: #060511;
            letter-spacing: 0.5px;
            font-family: 'Poppins', sans-serif;
        }

        label .required {
            color: #c22035;
        }

        input, select, textarea {
            padding: 10px 12px;
            border: 2px solid #86b2d3;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.2s;
            color: #060511;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #c22035;
            box-shadow: 0 0 0 3px rgba(194, 32, 53, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .checkbox-group {
            background: rgba(134, 178, 211, 0.1);
            padding: 16px;
            border-radius: 6px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            font-weight: normal;
            text-transform: none;
            cursor: pointer;
            margin: 0;
        }

        .button-group {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 2px solid #e5e7eb;
        }

        button {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 700;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-family: 'Poppins', sans-serif;
            text-transform: none;
        }

        .btn-primary {
            background: #c22035;
            color: white;
        }

        .btn-primary:hover {
            background: rgba(194, 32, 53, 0.9);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: white;
            color: #c22035;
            border: 2px solid #c22035;
        }

        .btn-secondary:hover {
            background: #c22035;
            color: white;
        }

        .info-box {
            background: rgba(134, 178, 211, 0.2);
            border-left: 4px solid #c22035;
            padding: 16px;
            border-radius: 4px;
            margin-top: 16px;
        }

        .info-box p {
            font-size: 14px;
            color: #060511;
            line-height: 1.6;
        }

        .success-message {
            display: none;
            background: #10b981;
            color: white;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .success-message.show {
            display: block;
        }

        .auto-filled {
            background-color: rgba(134, 178, 211, 0.1);
            position: relative;
        }

        .auto-badge {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: #86b2d3;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
            text-transform: uppercase;
            pointer-events: none;
        }

        .form-group {
            position: relative;
        }

        .helper-text {
            font-size: 11px;
            color: #a7a8a3;
            margin-top: 4px;
            font-style: italic;
            font-family: 'Poppins', sans-serif;
        }

        .helper-text.auto-info {
            color: #86b2d3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <!-- Background Circle -->
                        <circle cx="50" cy="50" r="45" fill="#c22035"/>

                        <!-- Curved text "LEAST OF THESE" on top -->
                        <defs>
                            <path id="textTop" d="M 15 50 A 35 35 0 0 1 85 50" fill="none"/>
                        </defs>
                        <text fill="white" font-size="5.5" font-weight="400" letter-spacing="0.5">
                            <textPath href="#textTop" startOffset="50%" text-anchor="middle">
                                LEAST OF THESE
                            </textPath>
                        </text>

                        <!-- Curved text "CAROLINAS" on bottom -->
                        <defs>
                            <path id="textBottom" d="M 15 50 A 35 35 0 0 0 85 50" fill="none"/>
                        </defs>
                        <text fill="white" font-size="7" font-weight="400" letter-spacing="0.5">
                            <textPath href="#textBottom" startOffset="50%" text-anchor="middle">
                                CAROLINAS
                            </textPath>
                        </text>

                        <!-- Three children silhouettes (simplified representations) -->
                        <!-- Child 1 - Running/jumping on left -->
                        <g fill="white">
                            <!-- Head -->
                            <circle cx="32" cy="45" r="4"/>
                            <!-- Body -->
                            <ellipse cx="32" cy="53" rx="3" ry="6"/>
                            <!-- Left arm -->
                            <path d="M 30 50 L 27 52"/>
                            <!-- Right arm -->
                            <path d="M 34 50 L 37 48"/>
                            <!-- Left leg -->
                            <path d="M 30 58 L 28 64"/>
                            <!-- Right leg -->
                            <path d="M 34 58 L 35 63"/>
                        </g>

                        <!-- Child 2 - Center, taller -->
                        <g fill="white">
                            <!-- Head -->
                            <circle cx="50" cy="42" r="4.5"/>
                            <!-- Body -->
                            <ellipse cx="50" cy="52" rx="3.5" ry="7"/>
                            <!-- Left arm -->
                            <path d="M 47 49 L 44 51"/>
                            <!-- Right arm -->
                            <path d="M 53 49 L 56 51"/>
                            <!-- Left leg -->
                            <path d="M 48 58 L 47 65"/>
                            <!-- Right leg -->
                            <path d="M 52 58 L 53 65"/>
                        </g>

                        <!-- Child 3 - Right, running/jumping -->
                        <g fill="white">
                            <!-- Head -->
                            <circle cx="68" cy="46" r="3.8"/>
                            <!-- Body -->
                            <ellipse cx="68" cy="54" rx="3" ry="5.5"/>
                            <!-- Left arm -->
                            <path d="M 66 51 L 63 49"/>
                            <!-- Right arm -->
                            <path d="M 70 51 L 73 53"/>
                            <!-- Left leg -->
                            <path d="M 66 59 L 64 62"/>
                            <!-- Right leg -->
                            <path d="M 70 59 L 72 64"/>
                        </g>

                        <!-- Make paths visible -->
                        <style>
                            path {
                                stroke: white;
                                stroke-width: 2;
                                stroke-linecap: round;
                            }
                        </style>
                    </svg>
                </div>
                <div class="header-text">
                    <h1>Least of These Carolinas</h1>
                    <p>Bag of Hope - Pick List Form</p>
                </div>
            </div>
        </div>

        <div class="form-card">
            <div id="successMessage" class="success-message">
                ✓ Pick list submitted successfully!
            </div>

            <form id="bagOfHopeForm">
                <!-- Quick View Information -->
                <div class="section">
                    <h2 class="section-title">Quick View Information</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Child's First Name <span class="required">*</span></label>
                            <input type="text" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label>Child's Last Name <span class="required">*</span></label>
                            <input type="text" name="lastName" required>
                        </div>
                        <div class="form-group">
                            <label>Child's Age <span class="required">*</span></label>
                            <input type="number" name="age" id="age" min="0" max="18" required>
                        </div>
                        <div class="form-group">
                            <label>Birthday</label>
                            <input type="date" name="birthday" id="birthday">
                            <div class="helper-text">If you enter birthday, age will auto-calculate</div>
                        </div>
                        <div class="form-group">
                            <label>Gender <span class="required">*</span></label>
                            <select name="gender" required>
                                <option value="">Select gender</option>
                                <option value="female">Female</option>
                                <option value="male">Male</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ethnicity</label>
                            <select name="ethnicity">
                                <option value="">Select ethnicity</option>
                                <option value="african-american">African American</option>
                                <option value="caucasian">Caucasian</option>
                                <option value="hispanic">Hispanic</option>
                                <option value="asian">Asian</option>
                                <option value="multi-racial">Multi-racial</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Pickup Location <span class="required">*</span></label>
                            <select name="pickupLocation" required>
                                <option value="">Select location</option>
                                <option value="buncombe">Buncombe County/Asheville</option>
                                <option value="charlotte">Charlotte Office</option>
                                <option value="gastonia">Gastonia Center</option>
                                <option value="concord">Concord Location</option>
                                <option value="rock-hill">Rock Hill Center</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Bag Details -->
                <div class="section">
                    <h2 class="section-title">Bag Details</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Bag Embroidery Company</label>
                            <input type="text" name="embroideryCompany">
                        </div>
                        <div class="form-group">
                            <label>Bag Order Number</label>
                            <input type="text" name="orderNumber">
                        </div>
                        <div class="form-group">
                            <label>Bag Embroidery Color (Child's Favorite Color)</label>
                            <select name="embroideryColor" id="embroideryColor">
                                <option value="">Select color</option>
                                <option value="red">Red</option>
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                                <option value="yellow">Yellow</option>
                                <option value="purple">Purple</option>
                                <option value="pink">Pink</option>
                                <option value="orange">Orange</option>
                                <option value="black">Black</option>
                                <option value="white">White</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Toiletry Bag Color</label>
                            <select name="toiletryBagColor" id="toiletryBagColor">
                                <option value="">Select color</option>
                                <option value="red">Red</option>
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                                <option value="pink">Pink</option>
                                <option value="black">Black</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label>Toiletry Bag Labeled</label>
                            <input type="text" name="toiletryBagLabeled" placeholder="Label information">
                        </div>
                    </div>
                </div>

                <!-- Non-Clothing Items -->
                <div class="section">
                    <h2 class="section-title">Non-Clothing Items</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="toy" name="toy" value="toy">
                            <label for="toy">Toy/Activity ($25.00 value)</label>
                        </div>
                    </div>
                </div>

                <!-- Clothing Items -->
                <div class="section">
                    <h2 class="section-title">Clothing</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="tops" name="tops" value="tops">
                            <label for="tops">Tops</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="bottoms" name="bottoms" value="bottoms">
                            <label for="bottoms">Bottoms</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pajamas" name="pajamas" value="pajamas">
                            <label for="pajamas">Pajamas/Sleepwear</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="underwear" name="underwear" value="underwear">
                            <label for="underwear">Underwear</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="diaper" name="diaper" value="diaper">
                            <label for="diaper">Diaper/Pullup/Overnight</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="shoes" name="shoes" value="shoes">
                            <label for="shoes">Shoes (use only if needed)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="coat" name="coat" value="coat">
                            <label for="coat">Coat (use only if needed)</label>
                        </div>
                    </div>
                </div>

                <!-- Notes -->
                <div class="section">
                    <h2 class="section-title">Notes</h2>
                    <div class="form-group">
                        <label>Other BOH / Birthday Notes</label>
                        <textarea name="notes" placeholder="Enter any additional notes or special requirements..."></textarea>
                    </div>
                </div>

                <div class="info-box">
                    <p><strong>AFTER the bag has been fully packed:</strong> Update the Request Status to "Packed" in your system.</p>
                </div>

                <!-- Buttons -->
                <div class="button-group">
                    <button type="reset" class="btn-secondary">Clear Form</button>
                    <button type="submit" class="btn-primary">Submit Pick List</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ============================================
        // AUTO-POPULATION LOGIC
        // ============================================

        // Calculate age from birthday
        function calculateAgeFromBirthday(birthday) {
            if (!birthday) return null;

            const today = new Date();
            const birthDate = new Date(birthday);
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();

            // Adjust if birthday hasn't occurred this year
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            return age >= 0 ? age : null;
        }

        // Determine age group from age
        function getAgeGroupFromAge(age) {
            if (age === null || age === undefined || age === '') return '';

            const ageNum = parseInt(age);
            if (isNaN(ageNum)) return '';

            if (ageNum >= 0 && ageNum <= 2) return '0-2';
            if (ageNum >= 3 && ageNum <= 5) return '3-5';
            if (ageNum >= 6 && ageNum <= 11) return '6-11';
            if (ageNum >= 12) return '12+';

            return '';
        }

        // Add visual indicator for auto-filled field
        function markAsAutoFilled(element, sourceField) {
            element.classList.add('auto-filled');

            // Remove existing badge if present
            const existingBadge = element.parentElement.querySelector('.auto-badge');
            if (existingBadge) {
                existingBadge.remove();
            }

            // Add badge
            const badge = document.createElement('span');
            badge.className = 'auto-badge';
            badge.textContent = 'auto';
            badge.title = `Auto-filled from ${sourceField}`;
            element.parentElement.appendChild(badge);
        }

        // Remove auto-fill indicator
        function removeAutoFillIndicator(element) {
            element.classList.remove('auto-filled');
            const badge = element.parentElement.querySelector('.auto-badge');
            if (badge) {
                badge.remove();
            }
        }

        // Get elements
        const birthdayInput = document.getElementById('birthday');
        const ageInput = document.getElementById('age');
        const embroideryColorSelect = document.getElementById('embroideryColor');
        const toiletryBagColorSelect = document.getElementById('toiletryBagColor');

        // Birthday → Age
        birthdayInput.addEventListener('change', function() {
            const calculatedAge = calculateAgeFromBirthday(this.value);

            if (calculatedAge !== null) {
                ageInput.value = calculatedAge;
                markAsAutoFilled(ageInput, 'birthday');
            }
        });

        // Allow manual override of age (remove auto indicator when user edits)
        ageInput.addEventListener('input', function() {
            // Only remove indicator if user is manually typing (not from birthday)
            const isFromBirthday = this.classList.contains('auto-filled');
            if (isFromBirthday) {
                // Wait a moment to see if they're actually editing
                setTimeout(() => {
                    if (document.activeElement === this) {
                        removeAutoFillIndicator(this);
                    }
                }, 100);
            }
        });

        // Embroidery Color → Toiletry Bag Color
        embroideryColorSelect.addEventListener('change', function() {
            const selectedColor = this.value;

            // Only auto-fill if toiletry bag color is empty
            if (selectedColor && !toiletryBagColorSelect.value) {
                // Check if the selected color exists in toiletry bag options
                const toiletryOptions = Array.from(toiletryBagColorSelect.options).map(opt => opt.value);

                if (toiletryOptions.includes(selectedColor)) {
                    toiletryBagColorSelect.value = selectedColor;
                    markAsAutoFilled(toiletryBagColorSelect, 'embroidery color');
                }
            }
        });

        // Allow manual override of toiletry bag color
        toiletryBagColorSelect.addEventListener('change', function() {
            if (this.value) {
                removeAutoFillIndicator(this);
            }
        });

        // ============================================
        // FORM SUBMISSION
        // ============================================

        document.getElementById('bagOfHopeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            // Get all checked checkboxes
            const checkboxes = this.querySelectorAll('input[type="checkbox"]:checked');
            const checkedItems = Array.from(checkboxes).map(cb => cb.value);
            data.selectedItems = checkedItems;

            // Calculate age group automatically from age (backend logic)
            const age = parseInt(data.age);
            if (!isNaN(age)) {
                data.ageGroup = getAgeGroupFromAge(age);
            }

            // Track which fields were auto-populated
            const autoPopulatedFields = [];
            if (ageInput.classList.contains('auto-filled')) {
                autoPopulatedFields.push('age');
            }
            if (toiletryBagColorSelect.classList.contains('auto-filled')) {
                autoPopulatedFields.push('toiletryBagColor');
            }
            data.autoPopulatedFields = autoPopulatedFields;

            console.log('Form submitted:', data);

            // Show success message
            const successMessage = document.getElementById('successMessage');
            successMessage.classList.add('show');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Hide success message after 3 seconds
            setTimeout(() => {
                successMessage.classList.remove('show');
            }, 3000);

            // Optional: Reset form after submission
            // this.reset();
        });

        // ============================================
        // FORM RESET - Clean up auto-fill indicators
        // ============================================

        document.querySelector('.btn-secondary').addEventListener('click', function() {
            // Remove all auto-fill indicators when form is reset
            document.querySelectorAll('.auto-filled').forEach(el => {
                removeAutoFillIndicator(el);
            });
        });
    </script>
</body>
</html>
